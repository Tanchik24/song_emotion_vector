## Обоснованность разработки продукта
### Описание проекта: 
Проект создан для улучшения музыкальных рекомендательных систем на стриминговых сервисах путем учета эмоциональных характеристик песен в динамике.

Модель извлекает из треков значения arousal и valence каждые 30 секунд. На выходе модели получаем два вектора arousal и valence, длина которых зависит от выбранной средней продолжительности трека (например, 3 минуты). Полученные характеристики затем подаются в рекомендательные системы для улучшения подбора похожих песен для каждого пользователя.

Модель основана на модели Дж. Рассела, которая оценивает эмоциональное состояние трека на основе двух показателей - arousal и valence. Модель машинного обучения оценивает эти два показателя каждые 30 секунд, что дает более точную картину эмоциональной динамики песен.

### Бизнес цель
Цель проекта заключается в улучшении музыкальных рекомендательных систем для стриминговых сервисов, в обеспечении наилучшего подбора похожих песен для каждого пользователя.

Улучшение: проект учитывает эмоциональные характеристики песен в динамике. На данный момент большинстов рекомендательных систем используют общие показатели для оценки треков, что не всегда позволяет получить максимально точные рекомендации. Для решения этой проблемы было использована модель Дж. Рассела, которая позволит оценить эмоциональное состояние трека на основе двух показателей - arousal и valence. Модель машинного обучения оценивает эти два показателя каждые 6 секунд, что дает более точную картину эмоциональной динамики песен.

### Критерии успеха: 

1) бизнес метрика: average session duratio - метрика измеряет эффективность новой рекомендательной системы, насколько она увеличивает время, проведенное пользователем на платформе. Чем выше average session duration, тем выше вероятность, что пользователи продолжат использовать сервис.

2) ML метрика для рек систем: precision@k - метрика позволяет оценить, насколько точно рекомендательная система рекомендует пользователю песни, которые ему должны понравится. Высокое значение будет сигнализировать о том, что модель действительно учитывает эмоциональную составляющую песни.

$$precision@k (number of relevant recommended k items) / k$$ ,
где k - количество рекомендованных песен

3) Самая важная метрика: ML метрика RMSE (так как стоит задача регерссии) - оценивает насколько точно модель оценивает эмоционаьлные характеристики трека. Она позволит оценивать предсказание модели в тех же единицах измерения, что и сиходные данные.
$$RMSE = \sqrt{\frac{1}{n}\sum_{i=1}^{n}(y_i - \hat{y_i})^2}$$

Чем меньше RMSE тем выше precision@k, тем выше вероятность того, что пользователю будут рекомендоваться годные треки

### Baseline
Была разработана базовая модель, основанная на resnet34, и обучена на DEAM датасете в течение 20 эпох, чтобы проверить ее работоспособность. Затем была построена content-based рекомендательная система, с использыванием музыкальных признаков, извлеченных при помощи spotipy API, чтобы определить, могут ли вектора улучшить работу рекомендательной системы.

Для тестирования эффективности модели использовалось 50 первых плейлистов из датасета Million Playlists Dataset от Spotify. Первоначальная рекомендательная система, основанная на признаках, достигла метрики Precision@10 в 33,75%. Однако, модель была улучшена путем создания дополнительного датафрейма, который включал в себя предыдущие признаки, а также векторы arousal и valence, что привело к увеличению метрики Precision@10 до 35,25%. Было спарено 3000 треков.

Основные две таргетные переменные: arousal и valence 

### MVP
1) Для реализации проекта проводится сбор и обработка данных. Для составления качественного датасета по распределению valence и arousal необходимо собрать несколько датасетов. В случае необходимости, аудиозаписи могут быть разбиты на фрагменты по 30 секунд, после чего для каждого трека вычисляются значения arousal и valence каждые 30 секунд. В результате формируется csv-файл, содержащий название трека и соответствующие значения arousal и valence.

2) Разрабатывается модель машинного обучения для задачи регрессии (определения векторов arousal и valence). При этом рассматриваются различные варианты построения моделей, выбирается оптимальный вариант на основе метрики RMSE. Затем проводится проверка работы модели в рекомендательных системах на исторических данных пользователей с использованием метрики precision@k.

3) Разрабатывается веб-приложение с использованием фреймворка FastAPI, в которое будет интегрирована модель для извлечения векторов эмоций и рекомендательная система, основанная на этих векторах. Пользователи смогут выбирать песни и получать рекомендации на основе эмоциональных векторов через пользовательский интерфейс (UI). Количество рекомендаций, которые пользователь желает получить, также будет настраиваемо.

Бизнес, использующий рекомендательную систему, сможет воспользоваться моделью при помощи API

selenium - файлы для парсинга песен 
build_music_rec_sys.ipynb - простая рек ситемя для PoC
emovec:
gpt.py - для интерпритации результатов модели 
utils.py - содержит необходимые функции для модели 
model - содержит класс самой модели 
emovec_api.py - использование FastAPI
